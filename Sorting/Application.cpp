#include <vector>
#include <utility>
#include <iostream>
#include <thread>
#include <functional>
#include <ctime>


int partitioningStep(std::vector<int> &list, int startIndex, int endIndex) {
	int partitioningElement = list[startIndex];
	int partioningLocation = startIndex;

	int rightBorder = 0;
	int leftBorder = 0;

	bool done = false;

	while (!done) {

		if (!done) {
			for (int i = endIndex; i > startIndex - 1; i--) {
				if (list[i] < partitioningElement) {
					std::swap(list[partioningLocation], list[i]);
					leftBorder = partioningLocation;
					partioningLocation = i;
					break;
				}
				else if (list[i] == partitioningElement) {
					done = true;
					break;
				}
			}
		}

		if (!done) {
			for (int i = leftBorder + 1; i < endIndex + 1; i++) {
				if (list[i] > partitioningElement) {
					std::swap(list[partioningLocation], list[i]);
					rightBorder = partioningLocation;
					partioningLocation = i;
					break;
				}
				else if (list[i] == partitioningElement) {
					done = true;
					break;
				}
			}
		}

	}
	return partioningLocation;
}

void quickSortHelper(std::vector<int> &list, int startIndex, int endIndex) {
	if (startIndex >= endIndex) {
		return;
	}

	int middleIndex = partitioningStep(list, startIndex, endIndex);

	quickSortHelper(list, startIndex, middleIndex - 1);
	quickSortHelper(list, middleIndex + 1, endIndex);

}

int main() {

	std::vector<int> list = { 1463, 3702, 1180, 1896, 6372, 4667, 6830, 7237, 6602, 7633, 2700, 2788, 7330, 7654, 6244, 9757, 6284, 5518, 500, 6984, 9596, 2965, 5429, 1650, 1675, 5023, 3596, 4240, 334, 789, 8352, 9090, 422, 6323, 3945, 3705, 840, 3590, 9425, 9381, 1528, 510, 2932, 8624, 5548, 9305, 2177, 3482, 5396, 7530, 7539, 4544, 2401, 7554, 7556, 5907, 3910, 5495, 6419, 4398, 8507, 3373, 56, 1138, 7061, 9491, 6212, 7757, 7184, 7628, 6008, 531, 5565, 77, 9235, 8385, 6646, 3259, 9500, 4650, 8278, 7272, 7493, 9906, 3750, 759, 5600, 8597, 6799, 2295, 2051, 2220, 9749, 9340, 7107, 4138, 5776, 5024, 5345, 361, 4722, 3746, 3643, 9470, 2333, 3785, 7399, 1756, 3203, 9740, 5651, 1129, 4422, 9188, 2669, 444, 781, 554, 4878, 4976, 5159, 1207, 454, 3578, 74, 4993, 6114, 6653, 5584, 7851, 4296, 8758, 9174, 3793, 6849, 3948, 6889, 378, 862, 1027, 2193, 104, 7684, 330, 7474, 6529, 6689, 9609, 6245, 9361, 6385, 8323, 6479, 2810, 8975, 5643, 7135, 5724, 9226, 1374, 8711, 5241, 6032, 1671, 337, 634, 3867, 5936, 166, 1454, 9526, 6654, 8512, 5867, 5854, 9472, 7109, 5650, 452, 1318, 7741, 3718, 7225, 8269, 8881, 8695, 4576, 6311, 5657, 1797, 7735, 8752, 9478, 5077, 5269, 12, 3626, 5714, 4460, 797, 1612, 1823, 3787, 3893, 7496, 2175, 8109, 2949, 989, 6466, 5475, 6099, 7162, 2451, 7563, 6428, 675, 3398, 7441, 2842, 7222, 8838, 610, 1448, 6562, 1236, 245, 543, 9278, 9634, 2954, 629, 475, 5898, 3969, 3102, 4573, 2431, 4411, 9259, 6811, 6100, 20, 3145, 1746, 9504, 6533, 4592, 2580, 2017, 3307, 4720, 5601, 6779, 8198, 5942, 142, 6459, 5141, 6026, 8367, 9766, 1346, 3313, 3636, 8203, 6621, 2444, 1065, 4630, 4617, 4841, 577, 3158, 6275, 5048, 95, 6240, 3542, 8324, 1239, 7480, 534, 9311, 1139, 2749, 5893, 9673, 1194, 5912, 6559, 9773, 3445, 3194, 8907, 6833, 4036, 3935, 1059, 6123, 1733, 5316, 6767, 3073, 2055, 4372, 5827, 1586, 1447, 6886, 8195, 729, 1282, 363, 8502, 3018, 7949, 5312, 2038, 3544, 8415, 8377, 3231, 4651, 1072, 5634, 4658, 8544, 1542, 4300, 3436, 1416, 1556, 1753, 2938, 6200, 8967, 3918, 1642, 2145, 7464, 5817, 9152, 7205, 6463, 3060, 970, 8204, 8954, 2985, 490, 7296, 8692, 9770, 8172, 8873, 2040, 5352, 9795, 3350, 8000, 9127, 7921, 3723, 6899, 8880, 5678, 3015, 7071, 9969, 2143, 1809, 1021, 7766, 192, 225, 4483, 6005, 5394, 5922, 4001, 9210, 7177, 6643, 8629, 6773, 8460, 1832, 9837, 7367, 4132, 868, 624, 4973, 3804, 3034, 4298, 4129, 3549, 5468, 9989, 7798, 4189, 8895, 3386, 6579, 494, 7849, 3608, 4355, 2524, 1722, 5208, 1031, 9833, 1923, 1540, 6560, 7307, 1941, 5962, 9720, 5853, 8248, 616, 4602, 3262, 9094, 8720, 6384, 9556, 4486, 5473, 9638, 7466, 2265, 4010, 84, 3340, 6528, 2494, 8131, 8493, 8346, 4263, 5512, 9404, 2259, 2430, 8580, 4561, 726, 7392, 9417, 9198, 6108, 8900, 4884, 2370, 8948, 6025, 9948, 8886, 2997, 8933, 8008, 8550, 516, 3709, 6439, 96, 6513, 1574, 5523, 5301, 9875, 1227, 6325, 5332, 4110, 2569, 8649, 5378, 1706, 2998, 2024, 8963, 9030, 9475, 9302, 6587, 5484, 6398, 7236, 2275, 254, 3273, 54, 900, 5829, 8732, 167, 9503, 2131, 2511, 5108, 5830, 4282, 9838, 2358, 8484, 7011, 4902, 93, 7180, 9018, 8547, 6578, 1222, 5158, 2812, 2374, 4525, 8515, 6911, 640, 3131, 408, 3685, 4731, 3163, 8701, 6106, 3744, 852, 9743, 4034, 1878, 7117, 6725, 6935, 3512, 7229, 5754, 7111, 3806, 6777, 5056, 3255, 7183, 5480, 1998, 2705, 544, 8072, 5490, 1184, 5059, 779, 4578, 4450, 796, 9828, 7768, 7030, 2578, 8808, 5328, 9493, 674, 2136, 4377, 9101, 270, 2469, 9424, 1851, 1226, 7147, 2632, 4504, 6417, 191, 9401, 6630, 592, 469, 2302, 1831, 9801, 7319, 9835, 6676, 1179, 6839, 2483, 8535, 5063, 8678, 7312, 1827, 5325, 9413, 7518, 5580, 8660, 8291, 6289, 2459, 5653, 306, 4155, 7662, 2477, 7088, 3319, 4396, 2167, 7667, 9390, 7154, 5702, 3359, 6612, 4066, 4534, 1058, 3385, 1245, 2522, 8206, 169, 8218, 8631, 2214, 1422, 4562, 744, 7890, 3840, 6623, 1300, 8316, 8262, 1106, 7467, 4856, 7557, 3913, 8233, 8176, 9819, 1089, 266, 6910, 5925, 6960, 5713, 3101, 7054, 6979, 2633, 9245, 7822, 8999, 6876, 7853, 3796, 2487, 685, 2338, 914, 8891, 4442, 351, 3057, 8451, 9377, 6204, 5448, 7964, 1298, 4825, 8049, 3646, 9486, 8932, 7269, 4590, 8243, 3936, 248, 9660, 7391, 7911, 410, 3422, 1894, 5188, 7807, 9561, 1017, 1362, 7835, 5532, 3715, 7826, 3800, 9693, 815, 9159, 9655, 7360, 7726, 1859, 7262, 322, 6425, 8018, 9273, 4403, 1144, 580, 4473, 5136, 4249, 2803, 9191, 5674, 9082, 2682, 5308, 6874, 6504, 3146, 7457, 1181, 2509, 6104, 9885, 3921, 1578, 1800, 4183, 1363, 1402, 7242, 3031, 7033, 4598, 3183, 4611, 7693, 4369, 4721, 804, 8231, 484, 3905, 2128, 3369, 8941, 1516, 7320, 5258, 5039, 7833, 2142, 2735, 1699, 9538, 1146, 5533, 6303, 7064, 2629, 1156, 4872, 2594, 1966, 5015, 8005, 6327, 5406, 3127, 2708, 7916, 9769, 9627, 380, 8715, 3441, 9850, 3230, 8160, 5732, 4965, 7806, 5438, 3778, 7416, 9644, 3719, 4853, 3540, 2148, 1231, 1038, 7603, 969, 6319, 2263, 1008, 7220, 8389, 2160, 1645, 8788, 3783, 3686, 7120, 1344, 8044, 4203, 7637, 1798, 5428, 7715, 4653, 8403, 2264, 1914, 1228, 591, 2777, 1514, 3883, 8110, 1166, 5134, 8080, 3404, 6870, 2421, 3458, 5195, 6133, 1085, 5273, 5055, 4842, 1634, 1810, 3773, 6622, 9771, 9554, 1750, 7791, 835, 9153, 519, 1382, 2809, 2063, 4180, 4337, 6062, 1795, 8959, 9146, 881, 676, 3033, 8818, 7627, 3453, 9988, 9823, 7525, 7364, 4991, 372, 8578, 8255, 9603, 125, 3559, 2874, 1248, 1410, 9550, 2184, 9358, 2689, 4193, 8994, 4910, 9509, 16, 8759, 8785, 8395, 1491, 5803, 9463, 1935, 6940, 6670, 5720, 5122, 4030, 4047, 247, 9317, 8719, 9147, 5403, 9904, 1396, 3210, 4266, 6763, 1247, 5796, 2205, 7132, 1660, 8827, 7422, 2080, 3246, 3269, 3063, 4508, 4940, 8761, 5458, 3429, 2595, 5873, 4589, 5203, 2059, 1946, 7692, 5489, 6877, 4374, 2437, 8140, 6931, 409, 6837, 7978, 9780, 5675, 2382, 1052, 2479, 9542, 4732, 4480, 6409, 2095, 4347, 853, 5287, 9171, 51, 2585, 5529, 1469, 657, 6349, 7677, 6840, 2923, 7630, 5544, 2747, 4616, 30, 5837, 5520, 9575, 8284, 9456, 9467, 3435, 190, 4661, 6624, 4812, 4247, 5635, 1921, 42, 3419, 2928 };

	clock_t time1, time2;
	time1 = std::clock();

	//quickSortHelper(list, 0, list.size() - 1);

	int middleIndex = partitioningStep(list, 0, list.size() - 1);

	std::vector<int> list1(list.begin(), list.begin() + middleIndex);
	std::vector<int> list2(list.begin() + middleIndex, list.end());

	std::thread t1(quickSortHelper, std::ref(list1), 0, list1.size() -1);
	std::thread t2(quickSortHelper, std::ref(list2), 0, list2.size() -1);

	t1.join();
	t2.join();

	time2 = std::clock();
	double time = double(time2 - time1) / CLOCKS_PER_SEC;
	std::cout << time << " seconds\n";



	return 0;
}